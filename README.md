# Утилита для переноса данных Excel

Это простое консольное приложение для парсинга данных из одного файла Excel (`source.xlsx`) и вставки их в другой файл Excel (`destination.xlsx`) в определённые места.

## Особенности

-   **Перенос данных по ключу**: Сопоставляет строки в исходном и целевом файлах по значениям в колонке `KEY`.
-   **Гибкость**: Легко адаптируется для работы с разными именами файлов, листов и колонок.
-   **Обработка ошибок**: Предусмотрены проверки на отсутствие файлов, листов или необходимых колонок.
-   **Командная строка**: Удобный запуск и настройка через аргументы командной строки.
-   **Тесты**: Включает набор юнит-тестов для проверки корректности работы.

## Требования

-   Python 3.8+
-   Библиотеки, перечисленные в `requirements.txt` (`pandas`, `openpyxl`).

## Установка

1.  **Клонируйте репозиторий**:
    ```bash
    git clone <repository_url>
    cd excel-parse
    ```

2.  **Установите зависимости**:
    Рекомендуется использовать виртуальное окружение.
    ```bash
    python -m venv venv
    source venv/bin/activate  # Для Windows: venv\Scripts\activate
    pip install -r requirements.txt
    ```

## Использование

Для запуска скрипта используйте следующую команду:

```bash
python src/main.py <source_file> <destination_file> [--sheet <sheet_name>]
```

-   `<source_file>`: Имя исходного файла в папке `data`.
-   `<destination_file>`: Имя целевого файла в папке `data`.
-   `--sheet <sheet_name>`: (Опционально) Имя листа Excel для обработки. По умолчанию `Sheet1`.

### Пример запуска

```bash
python src/main.py source.xlsx destination.xlsx
```

После выполнения команды данные из `data/source.xlsx` будут перенесены в `data/destination.xlsx`.

## Формат входных файлов

### `source.xlsx`

Исходный файл должен содержать как минимум три колонки:
-   `KEY`: Уникальный идентификатор для сопоставления строк.
-   `VALUE_1`: Первое значение для переноса.
-   `VALUE_2`: Второе значение для переноса.

**Пример `data/source.xlsx`:**

| KEY | VALUE_1 | VALUE_2 |
|-----|---------|---------|
| A   | 100     | X1      |
| B   | 200     | Y1      |
| C   | 300     | Z1      |

### `destination.xlsx`

Целевой файл должен содержать колонку `KEY` и колонки для вставки данных (например, `DATA_A` и `DATA_B`).

**`data/destination.xlsx` *до* выполнения скрипта:**

| KEY | DATA_A | DATA_B | SOME_OTHER_COLUMN |
|-----|--------|--------|-------------------|
| C   |        |        | foo               |
| A   |        |        | bar               |
| B   |        |        | baz               |
| E   | 999    | Q4     | qux               |

**`data/destination.xlsx` *после* выполнения скрипта:**

| KEY | DATA_A | DATA_B | SOME_OTHER_COLUMN |
|-----|--------|--------|-------------------|
| C   | 300    | Z1     | foo               |
| A   | 100    | X1     | bar               |
| B   | 200    | Y1     | baz               |
| E   | 999    | Q4     | qux               |

## Запуск тестов

Для проверки корректности работы приложения можно запустить юнит-тесты:

```bash
python -m unittest tests/test_main.py
```
